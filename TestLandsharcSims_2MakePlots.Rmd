---
title: "Test Landsharc sims - make plots"
author: "Katie Lotterhos"
date: "May 24, 2016"
output: html_document
---

```{r setup, include=FALSE}

### Make summary plots
```{r}

summarydf <- read.table("results/LandsharcSummary.txt", header=TRUE)
colnames(summarydf)<-sub(".ep", "",colnames(summarydf))
head(summarydf)


 stats <- c(3:6,9:12,13:16, 17:20)
    names2 <- names(summarydf)[stats]
    names2[5:16] <- c("Md", "Hd", "Kd", "Nd")
    colors <- c(rep("grey60", 4), rep("lightblue",4), rep("blue",4), rep("magenta",4))
    
  addtext <- function(){
    text(2.5, 0.9, "Univariate", cex=1.1)
    text(6.5, 0.9, "Multivariate\nDefault", cex=1.1, col="darkblue")
    text(10.5, 0.9, "Multivariate\nMCD cov", cex=1.1, col="blue")     
    text(14.5, 0.9, "Multivariate\nMCD cov &\nrobust points", cex=1.1, col="magenta") 
  }
  
pdf("results/LandsharcSummary.pdf", width = 15, height = 12)
    par(mfrow=c(4,1), mar=c(1,3,1,1),oma=c(1,3,1,0), cex=1.0)
    x <- 0.5
    y <- 1.1
   
    boxplot(summarydf[summarydf$demog=="IM",stats], col=colors,
            ylim=c(0,1.2), names=names2)
    text(x,y, "IM", cex=2)
    addtext()
    
    boxplot(summarydf[summarydf$demog=="IBD",stats], col=colors,
            ylim=c(0,1.2), names=names2)
    text(x,y, "IBD", cex=2)
    #addtext()
    
    boxplot(summarydf[summarydf$demog=="1R",stats], col=colors,
            ylim=c(0,1.2), names=names2)
    text(x,y, "1R", cex=2)
    #addtext()
    
    boxplot(summarydf[summarydf$demog=="2R",stats], col=colors,
            ylim=c(0,1.2), names=names2)
    text(x,y, "2R", cex=2)
    mtext("Empirical Power", side=2, outer=TRUE)
    #addtext()
    
dev.off()
# colMeans(summarydf[summarydf$demog=="IM",3:10])
# colMeans(summarydf[summarydf$demog=="IBD",3:10])
# colMeans(summarydf[summarydf$demog=="1R",3:10])
# colMeans(summarydf[summarydf$demog=="2R",3:10])

library(vioplot)

pdf("results/LandsharcSummary_MdHd.pdf", width = 10, height =8)
    par(mfrow=c(4,1), mar=c(1,3,1,1),oma=c(1,3,1,0), cex=1.0)
    x <- 0.5
    y <- 1.1
    stats <- c(9:10,13:14, 17:18)
    #colors <- c(rep("magenta",4), 
    colors <- c(rep("lightblue",2), rep("blue",2), rep("magenta",2))
    # vioplot(summarydf[summarydf$demog=="1R",stats[1]],
    #         summarydf[summarydf$demog=="1R",stats[2]],
    #         summarydf[summarydf$demog=="1R",stats[3]],
    #         summarydf[summarydf$demog=="1R",stats[4]],
    #         ylim=c(0,1.2), col = colors)
    boxplot(summarydf[summarydf$demog=="IM",stats], col=colors,
            ylim=c(0,1.2))
    text(x,y, "IM", cex=1.3)
    boxplot(summarydf[summarydf$demog=="IBD",stats], col=colors,
            ylim=c(0,1.2))
    text(x,y, "IBD", cex=1.3)
    boxplot(summarydf[summarydf$demog=="1R",stats], col=colors,
            ylim=c(0,1.2))
    text(x,y, "1R", cex=1.3)
    boxplot(summarydf[summarydf$demog=="2R",stats], col=colors,
            ylim=c(0,1.2))
    text(x,y, "2R", cex=1.3)
    mtext("Empirical Power", side=2, outer=TRUE)
dev.off()
```
